// Ms. Jarvis - With Real AI Brain Connection
async function sendMessage() {
    const messageInput = document.getElementById('messageInput');
    const chatMessages = document.getElementById('chatMessages');
    
    if (!messageInput || !chatMessages) {
        console.log('Chat elements not found');
        return;
    }
    
    const userMessage = messageInput.value.trim();
    if (userMessage === '') {
        return;
    }
    
    // Disable input during processing
    messageInput.disabled = true;
    const sendBtn = document.querySelector('.sendBtn');
    if (sendBtn) {
        sendBtn.disabled = true;
        sendBtn.textContent = 'Thinking...';
    }
    
    // Add user message
    addMessage(userMessage, 'user');
    
    // Clear input
    messageInput.value = '';
    
    // Connect to Ms. Jarvis Brain
    try {
        const response = await fetch('https://api.mountainshares.us/api/chat-with-mountainshares-brain', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Origin': window.location.origin
            },
            body: JSON.stringify({
                message: userMessage,
                userId: `mountain_user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                messageId: Date.now()
            })
        });

        if (response.ok) {
            const data = await response.json();
            addMessage(data.reply || "I'm having trouble with that request, sweetie.", 'host');
        } else {
            addMessage("I'm having some technical difficulties right now. Please try again in a moment.", 'host');
        }
    } catch (error) {
        console.error('Brain connection error:', error);
        addMessage("I seem to be having connection issues. Let me try to get back to you soon!", 'host');
    }
    
    // Re-enable input
    messageInput.disabled = false;
    if (sendBtn) {
        sendBtn.disabled = false;
        sendBtn.textContent = 'Send Message';
    }
    messageInput.focus();
}
// Check Ms. Jarvis Brain Connection
async function checkBrainConnection() {
    try {
        const response = await fetch('https://api.mountainshares.us/api/health');
        
        if (response.ok) {
            const healthData = await response.json();
            console.log('Ms. Jarvis Brain Connected ‚úÖ');
            
            // Update status indicator if it exists
            const statusLight = document.querySelector('.status-light');
            if (statusLight) {
                statusLight.style.background = '#38a169'; // Green
            }
            
            // Update wisdom sources count
            if (healthData.ai_models && Array.isArray(healthData.ai_models)) {
                const count = healthData.ai_models.length;
                const wisdomText = document.querySelector('.dashboard-section p strong');
                if (wisdomText) {
                    wisdomText.textContent = `${count} Wisdom Sources Active`;
                }
            }
        } else {
            console.log('Ms. Jarvis Brain Connection Issues ‚ö†Ô∏è');
        }
    } catch (error) {
        console.log('Ms. Jarvis Brain Offline üî¥');
    }
}
// Handle Enter key and initialize with brain connection
document.addEventListener('DOMContentLoaded', function() {
    const messageInput = document.getElementById('messageInput');
    
    if (messageInput) {
        messageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
    }
    
    // Check brain connection on load
    checkBrainConnection();
    
    console.log('Ms. Jarvis Chat Interface with AI Brain Loaded Successfully');
});
    <script>
    // Check Ms. Jarvis Brain Connection
    async function checkBrainConnection() {
        try {
            const response = await fetch('https://api.mountainshares.us/api/health');
            
            if (response.ok) {
                const healthData = await response.json();
                console.log('Ms. Jarvis Brain Connected ‚úÖ');
                
                // Update status indicator if it exists
                const statusLight = document.querySelector('.status-light');
                if (statusLight) {
                    statusLight.style.background = '#38a169'; // Green
                }
                
                // Update wisdom sources count
                if (healthData.ai_models && Array.isArray(healthData.ai_models)) {
                    const count = healthData.ai_models.length;
                    const wisdomText = document.querySelector('.dashboard-section p strong');
                    if (wisdomText) {
                        wisdomText.textContent = `${count} Wisdom Sources Active`;
                    }
                }
            } else {
                console.log('Ms. Jarvis Brain Connection Issues ‚ö†Ô∏è');
            }
        } catch (error) {
            console.log('Ms. Jarvis Brain Offline üî¥');
        }
    }

    // Ms. Jarvis - With Real AI Brain Connection
    async function sendMessage() {
        const messageInput = document.getElementById('messageInput');
        const chatMessages = document.getElementById('chatMessages');
        
        if (!messageInput || !chatMessages) {
            console.log('Chat elements not found');
            return;
        }
        
        const userMessage = messageInput.value.trim();
        if (userMessage === '') {
            return;
        }
        
        // Disable input during processing
        messageInput.disabled = true;
        const sendBtn = document.querySelector('.sendBtn');
        if (sendBtn) {
            sendBtn.disabled = true;
            sendBtn.textContent = 'Thinking...';
        }
        
        // Add user message
        addMessage(userMessage, 'user');
        
        // Clear input
        messageInput.value = '';
        
        // Connect to Ms. Jarvis Brain
        try {
            const response = await fetch('https://api.mountainshares.us/api/chat-with-mountainshares-brain', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Origin': window.location.origin
                },
                body: JSON.stringify({
                    message: userMessage,
                    userId: `mountain_user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                    messageId: Date.now()
                })
            });

            if (response.ok) {
                const data = await response.json();
                addMessage(data.reply || "I'm having trouble with that request, sweetie.", 'host');
            } else {
                addMessage("I'm having some technical difficulties right now. Please try again in a moment.", 'host');
            }
        } catch (error) {
            console.error('Brain connection error:', error);
            addMessage("I seem to be having connection issues. Let me try to get back to you soon!", 'host');
        }
        
        // Re-enable input
        messageInput.disabled = false;
        if (sendBtn) {
            sendBtn.disabled = false;
            sendBtn.textContent = 'Send Message';
        }
        messageInput.focus();
    }

    // Add message to chat
    function addMessage(message, type) {
        const chatMessages = document.getElementById('chatMessages');
        if (!chatMessages) return;
        
        const messageDiv = document.createElement('div');
        messageDiv.className = `chat-message ${type}`;
        
        const bubbleDiv = document.createElement('div');
        bubbleDiv.className = 'bubble-content';
        bubbleDiv.innerHTML = `
            <p>${message}</p>
            <div class="message-time">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
        `;
        
        messageDiv.appendChild(bubbleDiv);
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Handle Enter key and initialize with brain connection
    document.addEventListener('DOMContentLoaded', function() {
        const messageInput = document.getElementById('messageInput');
        
        if (messageInput) {
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
        }
        
        // Check brain connection on load
        checkBrainConnection();
        
        console.log('Ms. Jarvis Chat Interface with AI Brain Loaded Successfully');
    });
    </script>
</body>
</html>
